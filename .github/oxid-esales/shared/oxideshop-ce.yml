# {{ $ids := "oxideshop_ce" }}ids: {{ print $ids }}
# {{ $org := "oxid-esales" }}organisation: {{ print $org }}
# {{ $name := "oxideshop-ce" }}name: {{ print $name }}
phpunit:
  title: '{{ print $name }}-unit'
  container:
    options: '-e XDEBUG_MODE=coverage'
  custom_script: |
    find . -type f >files.txt
  configuration: '/var/www/vendor/{{ printf "%v/%v" $org $name }}/phpunit.xml'
  test: '/var/www/vendor/{{ printf "%v/%v" $org $name }}/tests/Unit'
  additional_options: '--bootstrap /var/www/vendor/{{ printf "%v/%v" $org $name }}/tests/bootstrap.php --coverage-clover=/var/www/unit_coverage.xml'
  logfile:
    prefix: 'phpunit_unit'
  output:
    prefix: 'phpunit-unit-{{ print $name }}-artifacts'
    files: |
      source/composer.json
      source/unit_coverage.xml
      generated_testplan.yaml
      source/source/log/oxideshop.log
      data/php/logs/error_log.txt
      files.txt
  coverage:
    prefix: 'coverage-reports-phpunit-unit-{{ print $name }}'
    path: 'source/unit_coverage.xml'

codeception:
  title: '{{ print $name }}'
  custom_script: |
    find . >files.txt
  configuration: /var/www/vendor/{{ printf "%v/%v" $org $name }}/tests/codeception.yml
  build_additional_options: '-vv'
  logfile:
    prefix: 'codeception-{{ print $name }}'
  output:
    prefix: 'codeception-acceptance-{{ print $name }}-artifacts'
    files: |
      docker-compose.yml
      source/composer.json
      source/composer.lock
      source/source/config.inc.php
      source/source/log/oxideshop.log
      data/php/logs/error_log.txt
      source/tests/Codeception/_output
      job_status*.txt
      generated_testplan.yaml
      files.txt
